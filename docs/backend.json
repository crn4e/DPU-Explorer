{
  "entities": {
    "Location": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Location",
      "type": "object",
      "description": "Represents a specific location on the DPU campus.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the location."
        },
        "name": {
          "type": "string",
          "description": "Name of the location (e.g., Building A, Cafeteria 1)."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the location."
        },
        "type": {
          "type": "string",
          "description": "Type of location (e.g., academic, food, sports)."
        },
        "latitude": {
          "type": "number",
          "description": "Latitude coordinate of the location."
        },
        "longitude": {
          "type": "number",
          "description": "Longitude coordinate of the location."
        },
        "openingHoursId": {
          "type": "string",
          "description": "Reference to OpeningHours. (Relationship: Location 1:1 OpeningHours)"
        },
        "announcement": {
          "type": "string",
          "description": "An optional announcement for the location."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "type",
        "latitude",
        "longitude",
        "openingHoursId"
      ]
    },
    "OpeningHours": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "OpeningHours",
      "type": "object",
      "description": "Represents the opening hours for a specific location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the opening hours."
        },
        "monday": {
          "type": "string",
          "description": "Opening hours for Monday, in a format like '08:00-17:00' or 'Closed'."
        },
        "tuesday": {
          "type": "string",
          "description": "Opening hours for Tuesday, in a format like '08:00-17:00' or 'Closed'."
        },
        "wednesday": {
          "type": "string",
          "description": "Opening hours for Wednesday, in a format like '08:00-17:00' or 'Closed'."
        },
        "thursday": {
          "type": "string",
          "description": "Opening hours for Thursday, in a format like '08:00-17:00' or 'Closed'."
        },
        "friday": {
          "type": "string",
          "description": "Opening hours for Friday, in a format like '08:00-17:00' or 'Closed'."
        },
        "saturday": {
          "type": "string",
          "description": "Opening hours for Saturday, in a format like '08:00-17:00' or 'Closed'."
        },
        "sunday": {
          "type": "string",
          "description": "Opening hours for Sunday, in a format like '08:00-17:00' or 'Closed'."
        },
        "locationId": {
          "type": "string",
          "description": "Reference to Location. (Relationship: Location 1:1 OpeningHours)"
        }
      },
      "required": [
        "id",
        "monday",
        "tuesday",
        "wednesday",
        "thursday",
        "friday",
        "saturday",
        "sunday",
        "locationId"
      ]
    },
    "Announcement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Announcement",
      "type": "object",
      "description": "Represents an announcement related to a specific location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the announcement."
        },
        "locationId": {
          "type": "string",
          "description": "Reference to Location. (Relationship: Location 1:N Announcement)"
        },
        "title": {
          "type": "string",
          "description": "Title of the announcement."
        },
        "content": {
          "type": "string",
          "description": "Content of the announcement."
        },
        "date": {
          "type": "string",
          "description": "Date of the announcement.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "locationId",
        "title",
        "content",
        "date"
      ]
    },
    "Image": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Image",
      "type": "object",
      "description": "Represents an image associated with a location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the image."
        },
        "locationId": {
          "type": "string",
          "description": "Reference to Location. (Relationship: Location 1:N Image)"
        },
        "url": {
          "type": "string",
          "description": "URL of the image.",
          "format": "uri"
        },
        "altText": {
          "type": "string",
          "description": "Alternative text for the image."
        }
      },
      "required": [
        "id",
        "locationId",
        "url",
        "altText"
      ]
    },
    "Admin": {
      "title": "Admin",
      "type": "object",
      "description": "Represents a user with full developer privileges.",
      "properties": {}
    },
    "AnnouncementAdmin": {
      "title": "Announcement Admin",
      "type": "object",
      "description": "Represents a user with privileges to manage announcements.",
      "properties": {}
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/locations/{locationId}",
        "definition": {
          "entityName": "Location",
          "schema": {
            "$ref": "#/backend/entities/Location"
          },
          "description": "Stores information about locations on the DPU campus.",
          "params": [
            {
              "name": "locationId",
              "description": "Unique identifier for the location."
            }
          ]
        }
      },
      {
        "path": "/locations/{locationId}/announcements/{announcementId}",
        "definition": {
          "entityName": "Announcement",
          "schema": {
            "$ref": "#/backend/entities/Announcement"
          },
          "description": "Stores announcements related to a specific location.",
          "params": [
            {
              "name": "locationId",
              "description": "Unique identifier for the location."
            },
            {
              "name": "announcementId",
              "description": "Unique identifier for the announcement."
            }
          ]
        }
      },
      {
        "path": "/locations/{locationId}/images/{imageId}",
        "definition": {
          "entityName": "Image",
          "schema": {
            "$ref": "#/backend/entities/Image"
          },
          "description": "Stores images associated with a specific location.",
          "params": [
            {
              "name": "locationId",
              "description": "Unique identifier for the location."
            },
            {
              "name": "imageId",
              "description": "Unique identifier for the image."
            }
          ]
        }
      },
      {
        "path": "/openingHours/{openingHoursId}",
        "definition": {
          "entityName": "OpeningHours",
          "schema": {
            "$ref": "#/backend/entities/OpeningHours"
          },
          "description": "Stores opening hours for locations.",
          "params": [
            {
              "name": "openingHoursId",
              "description": "Unique identifier for the opening hours."
            }
          ]
        }
      },
      {
        "path": "/admins/{userId}",
        "definition": {
          "entityName": "Admin",
          "schema": {
            "$ref": "#/backend/entities/Admin"
          },
          "description": "Marks a user as a dev/admin. Existence of a document indicates dev privileges.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/announcementAdmins/{userId}",
        "definition": {
            "entityName": "AnnouncementAdmin",
            "schema": {
                "$ref": "#/backend/entities/AnnouncementAdmin"
            },
            "description": "Marks a user as an announcement admin. Existence indicates announcement editing privileges.",
            "params": [
                {
                    "name": "userId",
                    "description": "Unique identifier for the user."
                }
            ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the DPU Explorer application, focusing on locations, their opening hours, announcements, and associated images. A flat collection for `locations` is created with subcollections for `announcements` and `images`, and a related collection for `openingHours`. This approach enables efficient querying and management of location-specific data. Authorization is achieved by denormalizing role information. `admins` and `announcementAdmins` collections are used. The existence of a document in these collections indicates specific privileges for that user. This structure supports the required QAPs (Rules Are Not Filters) because the rules can efficiently check user roles against specific document paths without needing to filter data based on content."
  }
}
